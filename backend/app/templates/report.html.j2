<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>{{ title }}</title>
  <style>
    :root {
      --theme: {{ theme_color }};
      --theme-dark: {{ theme_dark }};
      --theme-tint: {{ theme_tint }};
      --text: #111827;
      --muted: #6b7280;
      --bg: #ffffff;
      --card: #ffffff;
      --border: #e5e7eb;
      --shadow: 0 10px 30px rgba(17, 24, 39, 0.08);
    }

    {% if font_regular %}
    @font-face {
      font-family: "Noto Sans SC";
      font-style: normal;
      font-weight: 400;
      src: url("data:font/otf;base64,{{ font_regular }}") format("opentype");
      font-display: swap;
    }
    {% endif %}

    {% if font_bold %}
    @font-face {
      font-family: "Noto Sans SC";
      font-style: normal;
      font-weight: 700;
      src: url("data:font/otf;base64,{{ font_bold }}") format("opentype");
      font-display: swap;
    }
    {% endif %}

    * { box-sizing: border-box; }
    html, body { margin: 0; padding: 0; background: var(--bg); color: var(--text); }
    body { font-family: "Noto Sans SC", "Microsoft YaHei", "PingFang SC", "Hiragino Sans GB", Arial, sans-serif; line-height: 1.7; }

    @media print {
      * { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
      details.raw-md { display: none !important; }
    }

    .page {
      width: 794px;
      margin: 0 auto;
      padding: 28px 28px 40px;
    }

    .header {
      background: linear-gradient(135deg, #111827 0%, var(--theme-dark) 55%, var(--theme) 100%);
      color: white;
      border-radius: 14px;
      padding: 22px 22px;
      margin-bottom: 18px;
      position: relative;
      overflow: hidden;
    }
    .header::after {
      content: "";
      position: absolute;
      right: -60px;
      top: -60px;
      width: 180px;
      height: 180px;
      background: radial-gradient(circle, rgba(255,255,255,0.18), transparent 60%);
    }
    .header .kicker {
      font-size: 12px;
      letter-spacing: 0.12em;
      opacity: 0.9;
      text-transform: uppercase;
    }
    .header .title-row {
      display: flex;
      align-items: flex-end;
      justify-content: space-between;
      gap: 16px;
    }
    .header .title-row h1 {
      margin: 10px 0 6px;
      font-size: 26px;
      line-height: 1.3;
      flex: 1 1 auto;
      min-width: 0;
    }
    .header .brand-mark {
      flex: 0 0 auto;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 6px 10px;
      border-radius: 999px;
      background: rgba(255, 255, 255, 0.12);
      border: 1px solid rgba(255, 255, 255, 0.16);
      white-space: nowrap;
    }
    .header .brand-mark .logo {
      width: 22px;
      height: 22px;
      border-radius: 8px;
      background: rgba(255, 255, 255, 0.22);
      display: inline-flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
      font-size: 12px;
      line-height: 1;
    }
    .header .brand-mark .name {
      font-size: 12px;
      font-weight: 700;
      letter-spacing: 0.06em;
    }
    .header .meta {
      font-size: 12px;
      opacity: 0.9;
      display: flex;
      gap: 14px;
      flex-wrap: wrap;
    }
    .header .meta > div {
      padding: 6px 10px;
      border-radius: 999px;
      background: rgba(255, 255, 255, 0.12);
      border: 1px solid rgba(255, 255, 255, 0.16);
    }

    .card {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 14px;
      padding: 16px 16px;
      margin-bottom: 14px;
      box-shadow: var(--shadow);
    }
    .card h2 {
      margin: 0 0 10px;
      font-size: 14px;
      color: var(--theme);
    }

    .screenshot {
      display: flex;
      justify-content: center;
      padding: 10px 10px;
    }
    .screenshot img {
      max-width: 100%;
      max-height: 720px;
      border-radius: 10px;
      border: 1px solid var(--border);
      background: white;
    }

    /* Markdown 内容样式 */
    .md h1, .md h2, .md h3 { line-height: 1.35; }
    .md h1 {
      font-size: 22px;
      margin: 18px 0 12px;
      color: var(--theme-dark);
      padding-bottom: 10px;
      border-bottom: 3px solid var(--theme);
    }
    .md h2 {
      font-size: 16px;
      margin: 18px 0 10px;
      padding: 8px 12px;
      border-radius: 10px;
      border-left: 4px solid var(--theme);
      background: var(--theme-tint);
      color: var(--theme-dark);
      border: 1px solid var(--border);
    }
    .md h3 { font-size: 14px; margin: 14px 0 8px; color: var(--theme-dark); }
    .md p { margin: 8px 0; color: #111827; }
    .md ul, .md ol { margin: 8px 0 8px 20px; padding: 0; }
    .md li { margin: 4px 0; }
    .md blockquote {
      margin: 10px 0;
      padding: 10px 12px;
      border-left: 4px solid var(--theme);
      background: var(--theme-tint);
      border-radius: 10px;
      color: #374151;
    }
    .md strong, .md b { color: var(--theme-dark); }
    .md table {
      width: 100%;
      border-collapse: collapse;
      overflow: hidden;
      border-radius: 12px;
      border: 1px solid var(--border);
      background: white;
      margin: 10px 0;
    }
    .md th, .md td { padding: 10px 10px; border-bottom: 1px solid var(--border); vertical-align: top; }
    .md th {
      text-align: left;
      background: linear-gradient(135deg, var(--theme), var(--theme-dark));
      color: white;
      font-weight: 700;
    }
    .md tr:last-child td { border-bottom: none; }

    .raw-md summary {
      cursor: pointer;
      font-size: 12px;
      color: var(--muted);
    }
    .raw-md pre {
      white-space: pre-wrap;
      word-break: break-word;
      font-size: 12px;
      line-height: 1.6;
      background: #0b1020;
      color: #dbeafe;
      padding: 12px 12px;
      border-radius: 12px;
      overflow: hidden;
      border: 1px solid rgba(255,255,255,0.08);
    }
  </style>
</head>
<body>
  <div class="page">
    <div class="header">
      <div class="kicker">{{ module_name }}</div>
      <div class="title-row">
        <h1>{{ title }}</h1>
        <div class="brand-mark" aria-label="呈尚策划">
          <span class="logo">呈</span>
          <span class="name">呈尚策划</span>
        </div>
      </div>
      <div class="meta">
        {% if subtitle %}<div>{{ subtitle }}</div>{% endif %}
        {% if date_text %}<div>调研时间：{{ date_text }}</div>{% endif %}
      </div>
    </div>

    {% if screenshot_data_url %}
    <div class="card">
      <h2>截图</h2>
      <div class="screenshot">
        <img src="{{ screenshot_data_url }}" alt="截图" />
      </div>
    </div>
    {% endif %}

    <div class="card md">
      {{ content_html | safe }}
    </div>

    <details class="card raw-md">
      <summary>查看原始 Markdown（用于复制）</summary>
      <pre>{{ raw_markdown }}</pre>
    </details>
  </div>
</body>
</html>
